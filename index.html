<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>VintageAir — рейсы ЧукотАВИА</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.geodesic/Leaflet.Geodesic.min.js"></script>

<style>
body { font-family: Arial; padding: 20px; }
h2 { margin-bottom: 10px; }

.controls select, .controls button {
  padding: 6px;
  margin-right: 6px;
}

table {
  border-collapse: collapse;
  width: 100%;
  margin-top: 12px;
}

th, td {
  border: 1px solid #ccc;
  padding: 6px;
  text-align: center;
}

th { background: #eee; }

.buy {
  background: #1e88e5;
  color: white;
  border: none;
  padding: 6px 10px;
  cursor: pointer;
}

#map {
  height: 420px;
  margin-top: 20px;
}
</style>
</head>

<body>

<h2>✈️ VintageAir — рейсы ЧукотАВИА</h2>

<div class="controls">
  <select id="from"></select>
  <select id="to"></select>
  <select id="air"></select>
  <button onclick="resetAll()">Сброс</button>
</div>

<table>
<thead>
<tr>
  <th>Дата</th>
  <th>Откуда</th>
  <th>Куда</th>
  <th>Рейс</th>
  <th>Вылет</th>
  <th>Прилёт</th>
  <th>Самолёт</th>
  <th>Покупка</th>
</tr>
</thead>
<tbody id="rows"></tbody>
</table>

<div id="map"></div>

<script>
/* ===== DATA ===== */
const flights = [
  {date:'27.01.2026',o:'DYR',d:'БНГ',f:'15',dep:'10:00',arr:'11:20',air:'AN-24',p:19000},
  {date:'22.01.2026',o:'DYR',d:'ВГИ',f:'49',dep:'09:30',arr:'11:30',air:'DHC-6',p:7000},
  {date:'29.01.2026',o:'DYR',d:'KPW',f:'25',dep:'10:00',arr:'12:20',air:'AN-24',p:17000},
  {date:'20.01.2026',o:'DYR',d:'PVS',f:'113',dep:'10:00',arr:'12:00',air:'AN-24',p:15000},
  {date:'10.02.2026',o:'DYR',d:'KVM',f:'7',dep:'09:30',arr:'11:35',air:'MI-8',p:7000}
];

const coords = {
  DYR:[64.73,177.52],
  PVS:[64.38,-173.23],
  KPW:[67.83,166.13],
  ВГИ:[67.55,175.85],
  БНГ:[66.32,174.12],
  KVM:[67.05,179.25]
};

/* ===== SELECTS ===== */
const fromSel = document.getElementById("from");
const toSel = document.getElementById("to");
const airSel = document.getElementById("air");

function fill(sel, arr){
  sel.innerHTML = `<option value="">Все</option>`;
  [...new Set(arr)].forEach(v=>sel.add(new Option(v,v)));
}

fill(fromSel, flights.map(f=>f.o));
fill(toSel, flights.map(f=>f.d));
fill(airSel, flights.map(f=>f.air));

fromSel.onchange = render;
toSel.onchange = render;
airSel.onchange = render;

/* ===== MAP ===== */
const map = L.map('map').setView([64,180],3);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

let geoLayer = L.geodesic([], {steps:40}).addTo(map);

/* ===== RENDER ===== */
function render(){
  const data = flights.filter(f =>
    (!fromSel.value || f.o===fromSel.value) &&
    (!toSel.value || f.d===toSel.value) &&
    (!airSel.value || f.air===airSel.value)
  );

  document.getElementById("rows").innerHTML = "";
  geoLayer.setLatLngs([]);

  data.forEach(f=>{
    document.getElementById("rows").innerHTML += `
      <tr>
        <td>${f.date}</td>
        <td>${f.o}</td>
        <td>${f.d}</td>
        <td>${f.f}</td>
        <td>${f.dep}</td>
        <td>${f.arr}</td>
        <td>${f.air}</td>
        <td><a href="https://booking.chukotavia.com/websky/" target="_blank">
          <button class="buy">от ${f.p.toLocaleString()} ₽</button></a></td>
      </tr>
    `;

    if(coords[f.o] && coords[f.d]){
      geoLayer.addLatLngs([[coords[f.o],coords[f.d]]]);
    }
  });
}

function resetAll(){
  fromSel.value="";
  toSel.value="";
  airSel.value="";
  render();
}

render();
</script>

</body>
</html>
