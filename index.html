<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>VintageAir ‚Äî —Ä–µ–π—Å—ã –ß—É–∫–æ—Ç–ê–í–ò–ê</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="flights.js"></script>

<style>
body { font-family: Arial, sans-serif; padding:20px; background:#f4f6f8; }
.aircraft-showcase { display:flex; gap:16px; justify-content:center; margin-bottom:20px; }
.aircraft-card { background:#fff; padding:16px; border-radius:14px; cursor:pointer; }
.aircraft-card.active { border:2px solid #1e88e5; background:#e3f2fd; }
table { width:100%; background:#fff; border-collapse:collapse; margin-top:20px; }
th,td { border:1px solid #ccc; padding:6px; text-align:center; }
.buy { background:#1e88e5; color:#fff; border:none; padding:6px 10px; }
#map { height:400px; margin-top:20px; }
</style>
</head>

<body>

<h2>‚úàÔ∏è VintageAir ‚Äî —Ä–µ–π—Å—ã –ß—É–∫–æ—Ç–ê–í–ò–ê</h2>

<div class="aircraft-showcase">
  <div class="aircraft-card active" data-type="">üåç –í—Å—è —Å–µ—Ç—å</div>
  <div class="aircraft-card" data-type="AN-24">‚úàÔ∏è AN-24</div>
</div>

<table id="table">
<thead>
<tr>
  <th>–î–∞—Ç–∞</th><th>–û—Ç–∫—É–¥–∞</th><th>–ö—É–¥–∞</th><th>–†–µ–π—Å</th>
  <th>–í—ã–ª–µ—Ç</th><th>–ü—Ä–∏–ª—ë—Ç</th><th>–°–∞–º–æ–ª—ë—Ç</th><th></th>
</tr>
</thead>
<tbody id="rows"></tbody>
</table>

<div id="map"></div>

<script>
const AIRPORTS = {
  DYR:[64.734,177.741],
  PWE:[69.783,170.597],
  PVS:[64.378,-173.242]
};

let activeType = "";

function normalizeAircraft(a){
  if (a.includes("AN-24")) return "AN-24";
  return "";
}

function render(){
  rows.innerHTML = "";
  FLIGHTS
    .filter(f => !activeType || normalizeAircraft(f.aircraft) === activeType)
    .forEach(f => {
      rows.innerHTML += `
      <tr>
        <td>${f.date}</td>
        <td>${f.origin}</td>
        <td>${f.destination}</td>
        <td>${f.flight_number}</td>
        <td>${f.departure}</td>
        <td>${f.arrival}</td>
        <td>${f.aircraft}</td>
        <td>
          <a href="https://booking.chukotavia.com/websky/" target="_blank">
            <button class="buy">–æ—Ç ${f.price.toLocaleString()} ‚ÇΩ</button>
          </a>
        </td>
      </tr>`;
    });
  drawMap();
}

let map = L.map("map").setView([65,170],4);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);
let layer = L.layerGroup().addTo(map);

function drawMap(){
  layer.clearLayers();
  FLIGHTS.forEach(f=>{
    if(!AIRPORTS[f.origin] || !AIRPORTS[f.destination]) return;
    L.polyline([AIRPORTS[f.origin], AIRPORTS[f.destination]], {color:"#1976d2"}).addTo(layer);
  });
}

document.querySelectorAll(".aircraft-card").forEach(c=>{
  c.onclick=()=>{
    document.querySelectorAll(".aircraft-card").forEach(x=>x.classList.remove("active"));
    c.classList.add("active");
    activeType = c.dataset.type;
    render();
  };
});

render();
</script>

</body>
</html>
