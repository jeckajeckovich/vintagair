<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>ЧукотАВИА — поиск рейсов</title>

<style>
body {
  font-family: Arial, sans-serif;
  padding: 20px;
  background: #f7f7f7;
}

h2 {
  margin-bottom: 15px;
}

.filters {
  background: #fff;
  padding: 15px;
  border-radius: 8px;
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  align-items: center;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

select, input, button {
  padding: 8px;
  font-size: 14px;
}

button {
  cursor: pointer;
  border: none;
  border-radius: 4px;
}

#searchBtn {
  background: #1976d2;
  color: #fff;
}

#resetBtn {
  background: #ccc;
}

table {
  border-collapse: collapse;
  width: 100%;
  margin-top: 20px;
  background: #fff;
}

th, td {
  border: 1px solid #ddd;
  padding: 6px;
  text-align: center;
}

th {
  background: #eee;
}

#empty {
  margin-top: 30px;
  color: #777;
  text-align: center;
  font-size: 16px;
}
</style>
</head>

<body>

<h2>✈️ ЧукотАВИА — поиск рейсов</h2>

<div class="filters">
  <select id="from"><option value="">Откуда</option></select>
  <select id="to"><option value="">Куда</option></select>
  <select id="aircraft"><option value="">Тип ВС</option></select>

  <input type="date" id="dateFrom">
  <input type="date" id="dateTo">

  <button id="searchBtn">Показать рейсы</button>
  <button id="resetBtn">Сбросить</button>
</div>

<div id="empty">Выберите параметры поиска и нажмите «Показать рейсы»</div>

<table id="table" style="display:none">
<thead>
<tr>
  <th>Дата</th>
  <th>Откуда</th>
  <th>Куда</th>
  <th>Рейс</th>
  <th>Вылет</th>
  <th>Прилёт</th>
  <th>Самолёт</th>
  <th>Цена</th>
  <th>Мест</th>
</tr>
</thead>
<tbody id="rows"></tbody>
</table>

<script>
/* ===== CSV ДАННЫЕ ===== */
const RAW_CSV = `
date,origin,destination,flight_number,departure,arrival,aircraft,price,available
27.01.2026,DYR,БНГ,15,10:00,11:20,ANTONOV AN-24,19000.00,9
11.02.2026,DYR,БНГ,15,10:00,11:20,ANTONOV AN-24,19000.00,9
22.01.2026,DYR,ВГИ,49,09:30,11:30,DE HAVILLAND DHC-6 TWIN OTTER,7000.00,2
29.01.2026,DYR,ВГИ,3,10:00,12:00,DE HAVILLAND DHC-6 TWIN OTTER,7000.00,3
12.02.2026,DYR,ВГИ,3,10:00,12:00,DE HAVILLAND DHC-6 TWIN OTTER,7000.00,8
09.02.2026,DYR,KPW,25,10:00,12:20,ANTONOV AN-24,17000.00,9
03.02.2026,DYR,KVM,7,10:00,12:00,DE HAVILLAND DHC-6 TWIN OTTER,7000.00,2
10.02.2026,DYR,KVM,7,09:30,11:35,MI8/MI17/MI171/MI172,7000.00,7
20.01.2026,DYR,PVS,113,10:00,12:00,ANTONOV AN-24,15000.00,2
`;

/* ===== ПАРСИНГ ===== */
const lines = RAW_CSV.trim().split("\n");
const headers = lines.shift().split(",");
const flights = lines.map(l => {
  const v = l.split(",");
  let o = {};
  headers.forEach((h,i)=>o[h]=v[i]);
  return o;
});

/* ===== ВСПОМОГАТЕЛЬНОЕ ===== */
const normDate = d => {
  const p = d.split(".");
  return `${p[2]}-${p[1]}-${p[0]}`;
};

/* ===== ЗАПОЛНЕНИЕ ФИЛЬТРОВ ===== */
function fillSelect(id, values){
  const s=document.getElementById(id);
  [...new Set(values)].sort().forEach(v=>{
    s.add(new Option(v,v));
  });
}

fillSelect("from", flights.map(f=>f.origin));
fillSelect("to", flights.map(f=>f.destination));
fillSelect("aircraft", flights.map(f=>f.aircraft));

/* ===== ПОИСК ===== */
document.getElementById("searchBtn").onclick = () => {
  const from = fromSel.value;
  const to = toSel.value;
  const aircraft = aircraftSel.value;
  const df = dateFrom.value;
  const dt = dateTo.value;

  let res = flights.filter(f =>
    (!from || f.origin===from) &&
    (!to || f.destination===to) &&
    (!aircraft || f.aircraft===aircraft) &&
    (!df || normDate(f.date)>=df) &&
    (!dt || normDate(f.date)<=dt)
  );

  render(res);
};

document.getElementById("resetBtn").onclick = () => {
  fromSel.value="";
  toSel.value="";
  aircraftSel.value="";
  dateFrom.value="";
  dateTo.value="";
  document.getElementById("table").style.display="none";
  document.getElementById("empty").style.display="block";
};

const fromSel = document.getElementById("from");
const toSel = document.getElementById("to");
const aircraftSel = document.getElementById("aircraft");
const dateFrom = document.getElementById("dateFrom");
const dateTo = document.getElementById("dateTo");

function render(data){
  const tbody=document.getElementById("rows");
  tbody.innerHTML="";

  if(!data.length){
    tbody.innerHTML="<tr><td colspan='9'>Ничего не найдено</td></tr>";
  }

  data.forEach(f=>{
    tbody.innerHTML+=`
    <tr>
      <td>${f.date}</td>
      <td>${f.origin}</td>
      <td>${f.destination}</td>
      <td>${f.flight_number}</td>
      <td>${f.departure}</td>
      <td>${f.arrival}</td>
      <td>${f.aircraft}</td>
      <td>${Number(f.price).toLocaleString()} ₽</td>
      <td>${f.available}</td>
    </tr>`;
  });

  document.getElementById("empty").style.display="none";
  document.getElementById("table").style.display="table";
}
</script>

</body>
</html>
